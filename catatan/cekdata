select sum(credit) from (
select '411113' as coa,
                do.dtmDoc, do.bCash, do.szBranchId, di.szProductId, 0 as debit, abs(dip.decDiscInternal) as credit, -1 * dip.decDiscInternal as amount , do.szDocId 
            from dms_sd_docdo do
            join dms_sd_docdoitem di on di.szDocId = do.szDocId
            join dms_sd_docdoitemprice dip on dip.szDocId = do.szDocId and dip.intItemNumber = di.intItemNumber
            where do.szDocStatus = 'Applied' and abs(dip.decDiscInternal) > 0  and do.bCash = 0
                and do.szBranchId = '555'
                and do.dtmDoc between '2022-07-01' and '2022-07-31'
                )x